{% comment %}
  MailChimp is the go-to newsletter service for Shopify.
  Use the link below to find your MailChimp "form action"
  and insert it in your site settings.

  MailChimp newsletter integration and requirement:
   - http://docs.shopify.com/support/configuration/store-customization/where-do-i-get-my-mailchimp-form-action
{% endcomment %}
{%- capture newsletter_form_action -%}/contact{%- endcapture -%}
{%- capture newsletter_form -%}

{%- form 'customer', action: newsletter_form_action, class: 'input-group' -%}
{% if form.posted_successfully? %}

  <p class="password-newsletter-success">{{newsletter.success}}</p>
{% comment %} {% else %}
  <script>
    $(document).ready(function(){
      var newsletterSuccessPopup = (function(){
        
            var popup = $('.newsletter-success-modal');
            var close = popup.find('.close');
        	var success = popup.find('.success');
        	var error = popup.find('.error');
            var overlay = popup.find('.modal-overlay');
            popup.show();
        	error.hide();
        	success.show();
            $.cookie('emailSubcribeModal', 'closed', {
                expires: 1,
                path: '/'
            });
            close.off('click').on('click',function(){
                popup.fadeOut();
            });
            overlay.off('click').on('click',function(){
                popup.fadeOut();
            });
        })();
      	var newURL = location.href.split("?")[0];
        window.history.pushState('object', document.title, newURL);
    })
  </script>
{% endif %} {% endcomment %}
{% else %}
<script>
  $(document).ready(function(){
    if (window.location.href.indexOf('newsletter&form_type=customer') > -1) {
      var newsletterSuccessPopup = (function(){
        var popup = $('.newsletter-success-modal');
        var close = popup.find('.close');
        var success = popup.find('.success');
        var error = popup.find('.error');
        var overlay = popup.find('.modal-overlay');
        popup.show();
        error.show();
        success.hide();
        $.cookie('emailSubcribeModal', 'closed', {
          expires: 1,
          path: '/'
        });
        close.off('click').on('click',function(){
          popup.fadeOut();
        });
        overlay.off('click').on('click',function(){
          popup.fadeOut();
        });
      })();
      var newURL = location.href.split("?")[0];
      window.history.pushState('object', document.title, newURL);
    }
  })
</script>
{% endif %}
    <input type="hidden" name="contact[tags]" value="newsletter">
    <input class="input-group-field" type="email" name="contact[email]"  aria-label="Email Address" placeholder="{{ 'newsletter.label' | t }}" required="required">
    <button class="btn-submit btn" type="submit" value="{{ 'newsletter.button_label' | t }}">Subscribe</button>

{%- endform -%}
{% endcapture %}

{{ newsletter_form }}
